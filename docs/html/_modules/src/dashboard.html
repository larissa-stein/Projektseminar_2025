

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.dashboard &mdash; Projektseminar 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Projektseminar
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction and Motivation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../project_description.html">AI-supported market analysis of compensation &amp; benefits in M&amp;A integrations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deployment:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker_setup.html">Docker Setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick Start:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">System Architecture</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Source:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Projektseminar</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.dashboard</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.dashboard</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dash</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dash</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dash</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">dcc</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">State</span><span class="p">,</span> <span class="n">ALL</span><span class="p">,</span> <span class="n">no_update</span><span class="p">,</span> <span class="n">ctx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dash</span><span class="w"> </span><span class="kn">import</span> <span class="n">callback_context</span> <span class="k">as</span> <span class="n">ctx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.express</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">px</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dash_bootstrap_components</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dbc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">locale</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.data_download</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_database</span><span class="p">,</span> <span class="n">load_geojson</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.layouts</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_general_dashboard_layout</span><span class="p">,</span>
    <span class="n">get_comparison_dashboard_layout</span><span class="p">,</span>
    <span class="n">get_admin_dashboard_layout</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.jobs_upload</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">load_job_titles</span><span class="p">,</span> <span class="n">save_job_titles</span><span class="p">,</span> <span class="n">delete_job_title</span><span class="p">,</span> <span class="n">delete_all_job_titles</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.MongoDB</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_job_titles_to_mongodb</span>

<span class="c1"># Determine the base directory of the project</span>
<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>

<span class="c1"># Set locale for German month names in date formatting</span>
<span class="n">locale</span><span class="o">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="o">.</span><span class="n">LC_TIME</span><span class="p">,</span> <span class="s1">&#39;de_DE.UTF-8&#39;</span><span class="p">)</span>

<span class="c1"># Color scheme</span>
<span class="n">COLOR_1</span> <span class="o">=</span> <span class="s1">&#39;#AD1B02&#39;</span>
<span class="n">COLOR_2</span> <span class="o">=</span> <span class="s1">&#39;#D85604&#39;</span>
<span class="n">COLOR_3</span> <span class="o">=</span> <span class="s1">&#39;#E88D14&#39;</span>
<span class="n">COLOR_4</span> <span class="o">=</span> <span class="s1">&#39;#F3BE26&#39;</span>
<span class="n">COLOR_5</span> <span class="o">=</span> <span class="s1">&#39;#E669A2&#39;</span>  <span class="c1"># Pink</span>

<span class="c1"># Load data from the remote database (Google Drive)</span>
<span class="n">datenrahmen</span> <span class="o">=</span> <span class="n">load_database</span><span class="p">()</span>
<span class="k">if</span> <span class="n">datenrahmen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Datenbank konnte nicht geladen werden&quot;</span><span class="p">)</span>

<span class="c1"># Add mapping for types of employment</span>
<span class="n">beschaeftigungsart_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;befristet&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;befristet&#39;</span><span class="p">],</span>
    <span class="s1">&#39;unbefristet&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Feste Anstellung&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Convert date column to datetime format</span>
<span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span>

<span class="c1"># Group data for trendline plotting</span>
<span class="n">df_trend</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="s1">&#39;Portal_Name&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">)</span>

<span class="c1"># Load GeoJSON file for map visualization</span>
<span class="n">deutschland_geojson</span> <span class="o">=</span> <span class="n">load_geojson</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;bundeslaender.json&quot;</span><span class="p">))</span>

<span class="c1"># Load and encode the logo image for display in the dashboard</span>
<span class="n">logo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;Logo-pwc.png&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">logo_path</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logo_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image_file</span><span class="p">:</span>
        <span class="n">encoded_image</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">image_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logo-pwc.png nicht gefunden – das Logo wird nicht angezeigt.&quot;</span><span class="p">)</span>

<span class="c1"># Extract global filter options for dashboard interactivity</span>
<span class="n">job_portale</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">bundeslaender</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Land&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Deutschland&#39;</span><span class="p">][</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">beschaeftigungsarten</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">monate</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">berufserfahrungslevel</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">positionen</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">unternehmen</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="c1"># unternehmensgroessen = datenrahmen[&#39;Unternehmensgröße&#39;].unique()</span>
<span class="n">branchen</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># Define desired order of company sizes for consistent display</span>
<span class="n">unternehmensgroessen_sortiert</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;0-10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;11-50&quot;</span><span class="p">,</span>
    <span class="s2">&quot;51-250&quot;</span><span class="p">,</span>
    <span class="s2">&quot;251-500&quot;</span><span class="p">,</span>
    <span class="s2">&quot;501-1000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1001-2500&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2501-10000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;10000+&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Keine Angaben&quot;</span>
<span class="p">]</span>

<span class="c1"># Filter and keep only available sizes in defined order</span>
<span class="n">vorhandene_groessen</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">unternehmensgroessen</span> <span class="o">=</span> <span class="p">[</span><span class="n">groesse</span> <span class="k">for</span> <span class="n">groesse</span> <span class="ow">in</span> <span class="n">unternehmensgroessen_sortiert</span>
                        <span class="k">if</span> <span class="n">groesse</span> <span class="ow">in</span> <span class="n">vorhandene_groessen</span><span class="p">]</span>

<span class="c1"># Initialize Dash application</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Dash</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="n">external_stylesheets</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">BOOTSTRAP</span><span class="p">,</span>
                    <span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css&quot;</span>
                    <span class="c1"># Font Awesome for icons</span>
                <span class="p">],</span>
                <span class="n">suppress_callback_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># App Layout</span>
<span class="n">app</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>

    <span class="c1"># Temporary storage for job titles</span>
    <span class="n">dcc</span><span class="o">.</span><span class="n">Store</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">load_job_titles</span><span class="p">()),</span>

    <span class="c1"># Navigation bar at the top</span>
    <span class="n">dbc</span><span class="o">.</span><span class="n">Navbar</span><span class="p">(</span>
        <span class="n">dbc</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="c1"># Logo (left-aligned)</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">(</span>
                            <span class="n">html</span><span class="o">.</span><span class="n">Img</span><span class="p">(</span>
                                <span class="n">src</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;data:image/png;base64,</span><span class="si">{</span><span class="n">encoded_image</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                                <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;40px&#39;</span><span class="p">}</span>
                            <span class="p">),</span>
                            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
                            <span class="n">className</span><span class="o">=</span><span class="s2">&quot;me-2&quot;</span>  <span class="c1"># Spacing to the title</span>
                        <span class="p">),</span>

                        <span class="c1"># Dashboard title</span>
                        <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">(</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">NavbarBrand</span><span class="p">(</span><span class="s2">&quot;Dashboard - Job Analyse&quot;</span><span class="p">,</span> <span class="n">className</span><span class="o">=</span><span class="s2">&quot;ms-2&quot;</span><span class="p">),</span>
                            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
                        <span class="p">),</span>
                    <span class="p">],</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">className</span><span class="o">=</span><span class="s2">&quot;g-0&quot;</span>
                <span class="p">),</span>

                <span class="c1"># Right-aligned navigation items</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">NavbarToggler</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;navbar-toggler&quot;</span><span class="p">),</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Collapse</span><span class="p">(</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Nav</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">NavItem</span><span class="p">(</span>
                                <span class="n">dbc</span><span class="o">.</span><span class="n">NavLink</span><span class="p">(</span><span class="s2">&quot;Allgemeine Analyse der Stellenanzeigen&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;nav-allgemein&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)),</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">NavItem</span><span class="p">(</span><span class="n">dbc</span><span class="o">.</span><span class="n">NavLink</span><span class="p">(</span><span class="s2">&quot;Vergleich der Stellenanzeigen&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;nav-vergleich&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)),</span>
                            <span class="n">dbc</span><span class="o">.</span><span class="n">NavItem</span><span class="p">(</span><span class="n">dbc</span><span class="o">.</span><span class="n">NavLink</span><span class="p">(</span><span class="s2">&quot;Admin Bereich&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;nav-admin&quot;</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span><span class="p">)),</span>
                        <span class="p">],</span>
                        <span class="n">className</span><span class="o">=</span><span class="s2">&quot;ms-auto&quot;</span><span class="p">,</span>  <span class="c1"># Right-align nav items</span>
                        <span class="n">navbar</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">),</span>
                    <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;navbar-collapse&quot;</span><span class="p">,</span>
                    <span class="n">navbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">fluid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#6d6d6d&quot;</span><span class="p">,</span>
        <span class="n">dark</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>

    <span class="c1"># Main container with two-column layout</span>
    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
        <span class="c1"># Left column for filters (20% width) – ID used for visibility toggling</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-spalte&#39;</span><span class="p">,</span> <span class="n">children</span><span class="o">=</span><span class="p">[</span>
            <span class="c1"># Global filters</span>
            <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>

                <span class="c1"># Filter: Job Portal</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Jobportal&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">}</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">job_portale</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">opt</span><span class="p">)],</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Jobportal&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Filter: Bundesland</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Bundesland&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">}</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">bundeslaender</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">opt</span><span class="p">)],</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Bundesland&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Filter: date (Month selection)</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Monat&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">monat</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B %Y&#39;</span><span class="p">),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">monat</span><span class="p">}</span>
                                 <span class="k">for</span> <span class="n">monat</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">datenrahmen</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())],</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Monat&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Filter: Branche</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Branche&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">}</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">branchen</span><span class="p">],</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Branche(n)&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Filter: Position</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Position&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">}</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">positionen</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">opt</span><span class="p">)],</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Position&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Filter: Unternehmensgröße</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Unternehmensgröße&quot;</span><span class="p">,</span>
                               <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span> <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span> <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}),</span>
                    <span class="n">dcc</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">opt</span><span class="p">}</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">unternehmensgroessen</span><span class="p">],</span>
                        <span class="c1"># Verwendet die sortierte Liste</span>
                        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Wähle Unternehmensgröße&quot;</span><span class="p">,</span>
                        <span class="n">multi</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">]),</span>

                <span class="c1"># Additional filters: experience, work time model, contract type</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>

                    <span class="c1"># Filter: Berufserfahrung</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Berufserfahrung vorausgesetzt?&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span>
                        <span class="p">}),</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;Ja&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;Nein&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                            <span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginLeft&#39;</span><span class="p">:</span> <span class="s1">&#39;10px&#39;</span><span class="p">,</span> <span class="s1">&#39;verticalAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">},</span>
                            <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginRight&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">}</span>
                        <span class="p">)</span>
                    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}),</span>

                    <span class="c1"># Filter: Zeitmodell</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Zeitmodell&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span>
                        <span class="p">}),</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;Vollzeit&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Vollzeit&#39;</span><span class="p">},</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;Teilzeit&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Teilzeit&#39;</span><span class="p">}</span>
                            <span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginLeft&#39;</span><span class="p">:</span> <span class="s1">&#39;10px&#39;</span><span class="p">,</span> <span class="s1">&#39;verticalAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">},</span>
                            <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginRight&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">}</span>
                        <span class="p">)</span>
                    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">}),</span>

                    <span class="c1"># Filter: Beschäftigungsart</span>
                    <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Beschäftigungsart&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;fontSize&#39;</span><span class="p">:</span> <span class="s1">&#39;14px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span>
                        <span class="p">}),</span>
                        <span class="n">dcc</span><span class="o">.</span><span class="n">RadioItems</span><span class="p">(</span>
                            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span>
                            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;befristet&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;befristet&#39;</span><span class="p">},</span>
                                <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">html</span><span class="o">.</span><span class="n">Span</span><span class="p">(</span><span class="s1">&#39;unbefristet&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">}),</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;unbefristet&#39;</span><span class="p">}</span>
                            <span class="p">],</span>
                            <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;marginLeft&#39;</span><span class="p">:</span> <span class="s1">&#39;10px&#39;</span><span class="p">,</span> <span class="s1">&#39;verticalAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">},</span>
                            <span class="n">labelStyle</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginRight&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;80px&#39;</span><span class="p">}</span>
                        <span class="p">)</span>
                    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marginBottom&#39;</span><span class="p">:</span> <span class="s1">&#39;15px&#39;</span><span class="p">})</span>
                <span class="p">]),</span>

                <span class="c1"># &quot;Alle Filter löschen&quot; Button</span>
                <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">([</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                        <span class="s1">&#39;Alle Filter löschen&#39;</span><span class="p">,</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;filter-zuruecksetzen&#39;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;danger&#39;</span><span class="p">,</span>
                        <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">])</span>
            <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span>
                <span class="s1">&#39;backgroundColor&#39;</span><span class="p">:</span> <span class="s1">&#39;#f8f9fa&#39;</span><span class="p">,</span>
                <span class="s1">&#39;borderRadius&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span>
                <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;90vh&#39;</span><span class="p">,</span>  <span class="c1"># Reduced height to 90vh for better layout on smaller screens</span>
                <span class="s1">&#39;overflowY&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>  <span class="c1"># Adds scrollbar if content overflows</span>
            <span class="p">})</span>
        <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;20%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;90vh&#39;</span><span class="p">,</span>
            <span class="s1">&#39;boxSizing&#39;</span><span class="p">:</span> <span class="s1">&#39;border-box&#39;</span>  <span class="c1"># Ensures padding is included in width calculation</span>
        <span class="p">}),</span>

        <span class="c1"># Right column for dynamic dashboard content (takes remaining space)</span>
        <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;hauptinhalt&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;flex&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>  <span class="c1"># Occupies remaining space</span>
            <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span>
            <span class="s1">&#39;minWidth&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>  <span class="c1"># Prevents overflow issues with flex layout</span>
            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;90vh&#39;</span><span class="p">,</span>
            <span class="s1">&#39;overflowY&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>   <span class="c1"># Adds scrollbar for long content</span>
        <span class="p">})</span>
    <span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;flex&#39;</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;90vh&#39;</span><span class="p">,</span>
        <span class="s1">&#39;margin&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
        <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span>
    <span class="p">})</span>
<span class="p">])</span>


<span class="c1"># Callback to update the dashboard content based on the navigation bar selection</span>
<div class="viewcode-block" id="aktualisiere_dashboard">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.aktualisiere_dashboard">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;hauptinhalt&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-allgemein&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-vergleich&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-admin&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">aktualisiere_dashboard</span><span class="p">(</span><span class="n">nav_allgemein</span><span class="p">,</span> <span class="n">nav_vergleich</span><span class="p">,</span> <span class="n">nav_admin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the main content area of the dashboard based on the selected navigation item.</span>

<span class="sd">    This function reacts to user clicks on the navigation bar and displays the corresponding dashboard section:</span>

<span class="sd">    - **Allgemeine Analyse der Stellenanzeigen** loads the general job analysis dashboard.</span>
<span class="sd">    - **Vergleich der Stellenanzeigen** loads the comparison dashboard.</span>
<span class="sd">    - **Admin Bereich** loads the admin section.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        nav_allgemein (int or None): Number of clicks on the &quot;General Analysis&quot; nav item.</span>
<span class="sd">        nav_vergleich (int or None): Number of clicks on the &quot;Comparison&quot; nav item.</span>
<span class="sd">        nav_admin (int or None): Number of clicks on the &quot;Admin&quot; nav item.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dash.html.Div: The appropriate layout to render in the &#39;hauptinhalt&#39; div.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">load_database</span><span class="p">()</span>

    <span class="c1"># Return error message if data could not be loaded</span>
    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="s2">&quot;Daten konnten nicht geladen werden.&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">})</span>

    <span class="c1"># Initialize helper variables based on available dataframe columns</span>
    <span class="n">job_portale</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Portal_Name&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">bundeslaender</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Bundesland&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">branchen</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Kategorie&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">positionen</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Position&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">unternehmensgroessen</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Unternehmensgröße&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">unternehmen</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="k">if</span> <span class="s1">&#39;Unternehmen&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="c1"># Load the general dashboard layout by default or if no button has been clicked</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span> <span class="ow">or</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_general_dashboard_layout</span><span class="p">(</span>
            <span class="n">datenrahmen</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">encoded_image</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">job_portale</span><span class="o">=</span><span class="n">job_portale</span><span class="p">,</span>
            <span class="n">bundeslaender</span><span class="o">=</span><span class="n">bundeslaender</span><span class="p">,</span>
            <span class="n">branchen</span><span class="o">=</span><span class="n">branchen</span><span class="p">,</span>
            <span class="n">positionen</span><span class="o">=</span><span class="n">positionen</span><span class="p">,</span>
            <span class="n">unternehmensgroessen</span><span class="o">=</span><span class="n">unternehmensgroessen</span>
        <span class="p">)</span>
    <span class="c1"># Identify which navigation button was clicked</span>
    <span class="n">button_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Load corresponding dashboard layout based on navigation item</span>
    <span class="k">if</span> <span class="n">button_id</span> <span class="o">==</span> <span class="s1">&#39;nav-allgemein&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_general_dashboard_layout</span><span class="p">(</span>
            <span class="n">datenrahmen</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">encoded_image</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">job_portale</span><span class="o">=</span><span class="n">job_portale</span><span class="p">,</span>
            <span class="n">bundeslaender</span><span class="o">=</span><span class="n">bundeslaender</span><span class="p">,</span>
            <span class="n">branchen</span><span class="o">=</span><span class="n">branchen</span><span class="p">,</span>
            <span class="n">positionen</span><span class="o">=</span><span class="n">positionen</span><span class="p">,</span>
            <span class="n">unternehmensgroessen</span><span class="o">=</span><span class="n">unternehmensgroessen</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">button_id</span> <span class="o">==</span> <span class="s1">&#39;nav-vergleich&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_comparison_dashboard_layout</span><span class="p">(</span>
            <span class="n">datenrahmen</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
            <span class="n">unternehmen</span><span class="o">=</span><span class="n">unternehmen</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">button_id</span> <span class="o">==</span> <span class="s1">&#39;nav-admin&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">get_admin_dashboard_layout</span><span class="p">()</span></div>



<span class="c1"># Callback for admin password verification</span>
<div class="viewcode-block" id="passwort_prüfen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.passwort_prüfen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;admin-inhalt&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;passwort-modal&#39;</span><span class="p">,</span> <span class="s1">&#39;is_open&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;passwort-feedback&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;passwort-bestaetigen&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;admin-passwort-eingabe&#39;</span><span class="p">,</span> <span class="s1">&#39;n_submit&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;admin-passwort-eingabe&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">passwort_prüfen</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">n_submit</span><span class="p">,</span> <span class="n">passwort</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies the entered password to grant access to the admin section of the dashboard.</span>

<span class="sd">    This callback checks whether a user has clicked the &quot;Bestätigen&quot; button or submitted the password field</span>
<span class="sd">    via Enter key. If the provided password matches the predefined correct password, the admin section becomes visible.</span>
<span class="sd">    Otherwise, the password modal remains open and an error message is shown.</span>

<span class="sd">    The correct password is currently hardcoded in the application and can be freely defined by the developer.</span>
<span class="sd">    It is strongly recommended to use a more secure and complex password than the placeholder used here,</span>
<span class="sd">    especially in production environments.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_clicks (int or None): Number of clicks on the &quot;Confirm Password&quot; button.</span>
<span class="sd">        n_submit (int or None): Number of submissions via Enter key from the password input.</span>
<span class="sd">        passwort (str or None): The user-entered password string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple:</span>
<span class="sd">            - dict: CSS style to show/hide the admin content div.</span>
<span class="sd">            - bool: Flag to open/close the password modal.</span>
<span class="sd">            - str: Feedback message displayed to the user in case of incorrect password.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ctx</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">callback_context</span> <span class="c1"># Context to identify what triggered the callback</span>

    <span class="c1"># Only proceed if the callback was triggered</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">},</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Determine the triggering element (button or submit field)</span>
    <span class="n">trigger_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">trigger_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;passwort-bestaetigen&#39;</span><span class="p">,</span> <span class="s1">&#39;admin-passwort-eingabe&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">},</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Define the correct password (replace with more secure logic in production)</span>
    <span class="n">korrektes_passwort</span> <span class="o">=</span> <span class="s2">&quot;123&quot;</span>

    <span class="c1"># Check if entered password is correct</span>
    <span class="k">if</span> <span class="n">passwort</span> <span class="o">==</span> <span class="n">korrektes_passwort</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;flex&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">},</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="c1"># Show admin section, close modal</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">},</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Passwort ist falsch. Bitte erneut versuchen.&quot;</span> <span class="c1"># Keep modal open, show error</span></div>



<span class="c1"># Callbacks – General Dashboard</span>
<span class="c1"># Callback for updating figures and KPIs in the general dashboard</span>
<div class="viewcode-block" id="aktualisiere_allgemeine_diagramme">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.aktualisiere_allgemeine_diagramme">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;karte&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;unternehmensgroesse-balken&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;trend-linie&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;gesamtanzahl-karte&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;anzahl-jobtitel&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;anzahl-unternehmen&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">aktualisiere_allgemeine_diagramme</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span>
                                      <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters the dataset based on user selections in the dashboard and returns updated visualizations and KPIs.</span>

<span class="sd">    This callback function processes multiple user-defined filters and applies them to the underlying job advertisement</span>
<span class="sd">    dataset. Based on the filtered data, it generates and returns updated dashboard elements that provide both graphical</span>
<span class="sd">    and numerical insights.</span>

<span class="sd">    The function produces the following outputs:</span>

<span class="sd">    - A **choropleth map** showing the number of job advertisements per German federal state.</span>
<span class="sd">      Nationwide advertisements (&quot;bundesweit&quot;) are programmatically duplicated across all states.</span>
<span class="sd">    - Three **key performance indicators (KPIs)**: total number of unique advertisements, number of unique job titles, and number of unique companies.</span>
<span class="sd">    - A **bar chart** displaying the distribution of job advertisements by company size, ordered by defined size categories.</span>
<span class="sd">    - A **time-series line chart** illustrating the trend of job advertisements over time, differentiated by portal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list[str]): Selected job portals (e.g., &#39;Stepstone&#39;, &#39;Indeed&#39;).</span>
<span class="sd">        bundesland (list[str]): Selected German federal states.</span>
<span class="sd">        beschaeftigungsart (str): Selected type of employment (e.g., &#39;befristet&#39;, &#39;unbefristet&#39;).</span>
<span class="sd">        position (list[str]): Selected job positions.</span>
<span class="sd">        zeitmodell (str): Selected working time model (e.g., &#39;Vollzeit&#39;, &#39;Teilzeit&#39;).</span>
<span class="sd">        berufserfahrung (bool): Whether the position requires prior work experience.</span>
<span class="sd">        monate (list[str]): Selected months (format: &#39;YYYY-MM&#39;).</span>
<span class="sd">        unternehmensgroesse (list[str]): Selected company size categories.</span>
<span class="sd">        branche (list[str]): Selected industry categories.</span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple: (map figure, bar chart, line chart, total count, job title count, company count)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create a working copy of the global dataframe</span>
    <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Sequentially apply all filters</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span>
            <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[]))]</span>

    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span>
            <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span>
            <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span>
            <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefilterter_datenrahmen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="n">gefilterter_datenrahmen</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>

    <span class="c1"># Identify unique job ads using MongoDB_ID</span>
    <span class="n">eindeutige_anzeigen</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MongoDB_ID&#39;</span><span class="p">])</span>

    <span class="c1"># KPIs</span>
    <span class="n">gesamtanzahl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eindeutige_anzeigen</span><span class="p">)</span>
    <span class="n">anzahl_jobtitel</span> <span class="o">=</span> <span class="n">eindeutige_anzeigen</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
    <span class="n">anzahl_unternehmen</span> <span class="o">=</span> <span class="n">eindeutige_anzeigen</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

    <span class="c1"># Handle &#39;bundesweit&#39; cases by duplicating ads across all states</span>
    <span class="c1">#  List of all federal states</span>
    <span class="n">alle_bundeslaender</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Baden-Württemberg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bayern&#39;</span><span class="p">,</span> <span class="s1">&#39;Berlin&#39;</span><span class="p">,</span> <span class="s1">&#39;Brandenburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bremen&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Hamburg&#39;</span><span class="p">,</span> <span class="s1">&#39;Hessen&#39;</span><span class="p">,</span> <span class="s1">&#39;Mecklenburg-Vorpommern&#39;</span><span class="p">,</span> <span class="s1">&#39;Niedersachsen&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Nordrhein-Westfalen&#39;</span><span class="p">,</span> <span class="s1">&#39;Rheinland-Pfalz&#39;</span><span class="p">,</span> <span class="s1">&#39;Saarland&#39;</span><span class="p">,</span> <span class="s1">&#39;Sachsen&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Sachsen-Anhalt&#39;</span><span class="p">,</span> <span class="s1">&#39;Schleswig-Holstein&#39;</span><span class="p">,</span> <span class="s1">&#39;Thüringen&#39;</span><span class="p">]</span>

    <span class="c1"># Create a copy for the map display only</span>
    <span class="n">karten_daten</span> <span class="o">=</span> <span class="n">gefilterter_datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Find nationwide job advertisements</span>
    <span class="n">bundesweite_anzeigen</span> <span class="o">=</span> <span class="n">karten_daten</span><span class="p">[</span><span class="n">karten_daten</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bundesweit&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">bundesweite_anzeigen</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="c1"># Remove the original nationwide entries</span>
        <span class="n">karten_daten</span> <span class="o">=</span> <span class="n">karten_daten</span><span class="p">[</span><span class="n">karten_daten</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;bundesweit&#39;</span><span class="p">]</span>

        <span class="c1"># For each nationwide job advertisement: Add one entry per federal state</span>
        <span class="n">neue_eintraege</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">zeile</span> <span class="ow">in</span> <span class="n">bundesweite_anzeigen</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">bundesland</span> <span class="ow">in</span> <span class="n">alle_bundeslaender</span><span class="p">:</span>
                <span class="n">neue_zeile</span> <span class="o">=</span> <span class="n">zeile</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">neue_zeile</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bundesland</span>
                <span class="n">neue_eintraege</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neue_zeile</span><span class="p">)</span>

        <span class="c1"># Add the new entries to the DataFrame</span>
        <span class="k">if</span> <span class="n">neue_eintraege</span><span class="p">:</span>
            <span class="n">karten_daten</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">karten_daten</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">neue_eintraege</span><span class="p">)],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Always generate the job ad map, even if there are no nationwide postings</span>
    <span class="n">karten_figur</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">choropleth</span><span class="p">(</span>
        <span class="n">karten_daten</span><span class="p">,</span>
        <span class="n">geojson</span><span class="o">=</span><span class="n">deutschland_geojson</span><span class="p">,</span>
        <span class="n">locations</span><span class="o">=</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">,</span>
        <span class="n">featureidkey</span><span class="o">=</span><span class="s1">&#39;properties.name&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">karten_daten</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">)[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">),</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="p">[</span><span class="n">COLOR_1</span><span class="p">,</span> <span class="n">COLOR_2</span><span class="p">,</span> <span class="n">COLOR_3</span><span class="p">,</span> <span class="n">COLOR_4</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">karten_figur</span><span class="o">.</span><span class="n">update_geos</span><span class="p">(</span>
        <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">showcountries</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">countrycolor</span><span class="o">=</span><span class="s1">&#39;Black&#39;</span><span class="p">,</span>
        <span class="n">showsubunits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">subunitcolor</span><span class="o">=</span><span class="s1">&#39;Gray&#39;</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">51.1657</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mf">10.4515</span><span class="p">},</span>
        <span class="n">projection_type</span><span class="o">=</span><span class="s2">&quot;mercator&quot;</span><span class="p">,</span>
        <span class="n">fitbounds</span><span class="o">=</span><span class="s2">&quot;locations&quot;</span>
    <span class="p">)</span>
    <span class="n">karten_figur</span><span class="o">.</span><span class="n">update_coloraxes</span><span class="p">(</span><span class="n">cmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmax</span><span class="o">=</span><span class="n">karten_daten</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">karten_figur</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span><span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;&lt;b&gt;%</span><span class="si">{location}</span><span class="s2">&lt;/b&gt;: %</span><span class="si">{z}</span><span class="s2">&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class="p">)</span>

    <span class="c1"># Company Size Bar Chart</span>
    <span class="c1"># 1. Prepare and filter data</span>
    <span class="n">unternehmensgroesse_data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">eindeutige_anzeigen</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">:</span> <span class="s1">&#39;Kategorie&#39;</span><span class="p">})</span>
    <span class="p">)</span>

    <span class="c1"># 2. Sorting according to predefined sequence</span>
    <span class="n">vorhandene_kategorien</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">kategorie</span> <span class="k">for</span> <span class="n">kategorie</span> <span class="ow">in</span> <span class="n">unternehmensgroessen_sortiert</span>
        <span class="k">if</span> <span class="n">kategorie</span> <span class="ow">in</span> <span class="n">unternehmensgroesse_data</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="p">]</span>

    <span class="c1"># 3. Create data in the desired order</span>
    <span class="n">unternehmensgroesse_data</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span>
        <span class="n">unternehmensgroesse_data</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">],</span>
        <span class="n">categories</span><span class="o">=</span><span class="n">vorhandene_kategorien</span><span class="p">,</span>
        <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">unternehmensgroesse_data</span> <span class="o">=</span> <span class="n">unternehmensgroesse_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">)</span>

    <span class="c1"># 4. Create diagram</span>
    <span class="n">unternehmensgroesse_figur</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">unternehmensgroesse_data</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">:</span> <span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">,</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">:</span> <span class="s1">&#39;Anzahl Stellenanzeigen&#39;</span><span class="p">},</span>
        <span class="n">category_orders</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">:</span> <span class="n">vorhandene_kategorien</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># 5. Customize design</span>
    <span class="n">unternehmensgroesse_figur</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">marker_color</span><span class="o">=</span><span class="n">COLOR_1</span><span class="p">,</span>
        <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;Anzahl: %</span><span class="si">{y}</span><span class="s2">&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="c1"># 6. Optimize layout</span>
    <span class="n">unternehmensgroesse_figur</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Anzahl Stellenanzeigen&#39;</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>  <span class="c1"># Platz für x-Achsenbeschriftungen</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tickangle&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}</span>  <span class="c1"># Beschriftungen schräg stellen für bessere Lesbarkeit</span>
    <span class="p">)</span>

    <span class="c1"># Job Ad Trend Line Char</span>
    <span class="n">trend_data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">gefilterter_datenrahmen</span>
        <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MongoDB_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Portal_Name&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span> <span class="s1">&#39;Portal_Name&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">trend_figur</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
        <span class="n">trend_data</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">,</span>
        <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;stepstone&#39;</span><span class="p">:</span> <span class="n">COLOR_1</span><span class="p">,</span>
            <span class="s1">&#39;indeed&#39;</span><span class="p">:</span> <span class="n">COLOR_3</span>
        <span class="p">},</span>
    <span class="p">)</span>

    <span class="c1"># Always display points (even for individual data points)</span>
    <span class="n">trend_figur</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>  <span class="c1"># Always show lines + markers</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
        <span class="n">hovertemplate</span><span class="o">=</span><span class="s1">&#39;&lt;b&gt;%</span><span class="si">{fullData.name}</span><span class="s1">&lt;/b&gt;: %</span><span class="si">{y}</span><span class="s1">&lt;extra&gt;&lt;/extra&gt;&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Layout adjustments</span>
    <span class="n">trend_figur</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Anzahl Stellenanzeigen&#39;</span><span class="p">,</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Datum&#39;</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="c1"># Automatic tick calculation with nicer intervals</span>
            <span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
            <span class="n">autorange</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">rangemode</span><span class="o">=</span><span class="s1">&#39;tozero&#39;</span><span class="p">,</span>
            <span class="c1"># Do not display decimal places that are too small</span>
            <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;,.0f&#39;</span>
        <span class="p">),</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span>
        <span class="p">),</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
        <span class="n">hoverlabel</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
            <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
        <span class="p">),</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
        <span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;Jobportal&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Hover format</span>
    <span class="n">trend_figur</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">hovertemplate</span><span class="o">=</span><span class="s1">&#39;&lt;b&gt;%</span><span class="si">{fullData.name}</span><span class="s1">&lt;/b&gt;: %</span><span class="si">{y}</span><span class="s1">&lt;extra&gt;&lt;/extra&gt;&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">karten_figur</span><span class="p">,</span> <span class="n">unternehmensgroesse_figur</span><span class="p">,</span> <span class="n">trend_figur</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gesamtanzahl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">anzahl_jobtitel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">anzahl_unternehmen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<span class="c1"># Callback to reset all filter dropdowns when the reset button is clicked</span>
<div class="viewcode-block" id="reset_filters">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.reset_filters">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)],</span>  <span class="c1"># &lt;-- Korrekt integriert</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zuruecksetzen&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reset_filters</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears all selected global filter values when the &quot;Alle Filter löschen&quot; button is clicked.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_clicks (int or None): Number of times the reset button has been clicked.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of default (empty or None) values for all filters to reset the UI state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">n_clicks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Return default (empty) values for all filters</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># 9 Rückgabewerte</span>
    <span class="c1"># Also return default values if button hasn&#39;t been clicked yet (initial state)</span>
    <span class="k">return</span> <span class="p">[],</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span></div>



<span class="c1"># Callback to update the available job portal options based on current filter selections</span>
<div class="viewcode-block" id="update_job_portal_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_job_portal_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_job_portal_options</span><span class="p">(</span><span class="n">bundesland</span><span class="p">,</span> <span class="n">monat</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the job portal filter options based on other selected filters.</span>

<span class="sd">    Only job portals that are present in the currently filtered dataset will be displayed</span>
<span class="sd">    as selectable options in the dropdown menu.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        monat (list or None): Selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        branche (list or None): Selected industries/categories.</span>
<span class="sd">        position (list or None): Selected job positions.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company size categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available job portal options for the dropdown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a copy of the full dataset</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply each filter if selected</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">monat</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monat</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="c1"># Extract available job portals after filtering</span>
    <span class="n">verfuegbare_portale</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># Create dropdown option list (excluding missing values)</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">portal</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">portal</span><span class="p">}</span> <span class="k">for</span> <span class="n">portal</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_portale</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">portal</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback to update the available federal state (Bundesland) options based on current filter selections</span>
<div class="viewcode-block" id="update_bundesland_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_bundesland_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_bundesland_options</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">monat</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the federal state (Bundesland) filter options based on other selected filters.</span>

<span class="sd">    Only states present in the currently filtered dataset will be shown as options.</span>
<span class="sd">    This ensures that users can only select from values relevant to their current context.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        monat (list or None): Selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        branche (list or None): Selected industries/categories.</span>
<span class="sd">        position (list or None): Selected job positions.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company size categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available federal state options for the dropdown.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a full copy of the dataset</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply each selected filter</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">monat</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monat</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="c1"># Only include entries from Germany and extract unique federal states</span>
    <span class="n">verfuegbare_bundeslaender</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Land&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Deutschland&#39;</span><span class="p">][</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># Create dropdown option list (excluding missing values)</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">bundesland</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">bundesland</span><span class="p">}</span> <span class="k">for</span> <span class="n">bundesland</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_bundeslaender</span><span class="p">)</span> <span class="k">if</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback to update the available month filter options based on current filter selections</span>
<div class="viewcode-block" id="update_monat_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_monat_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_monat_options</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the month filter options based on other selected filters.</span>

<span class="sd">    Only months contained in the filtered results will be offered as selectable options.</span>
<span class="sd">    The displayed labels are formatted as &#39;Month Year&#39; (e.g. May 2025) to ensure clarity and improve user experience.</span>

<span class="sd">    This formatting decision was made in consultation with PwC to align with their preferred reporting structure.</span>
<span class="sd">    Since day-level granularity was not required for the analysis, a month-based view was intentionally implemented</span>
<span class="sd">    to simplify selection and interpretation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        branche (list or None): Selected industries/categories.</span>
<span class="sd">        position (list or None): Selected job positions.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company size categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available month options for the dropdown,</span>
<span class="sd">              where &#39;label&#39; is a formatted month name and &#39;value&#39; is the &#39;YYYY-MM&#39; string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a full copy of the dataset</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply each selected filter</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="c1"># Extract unique months in &#39;YYYY-MM&#39; format and sort them</span>
    <span class="n">verfuegbare_monate</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="c1"># Create dropdown option list with formatted month labels</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">monat</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B %Y&#39;</span><span class="p">),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">monat</span><span class="p">}</span> <span class="k">for</span> <span class="n">monat</span> <span class="ow">in</span> <span class="n">verfuegbare_monate</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback to update the available &quot;Branchen&quot;/industry filter options based on current filter selections</span>
<div class="viewcode-block" id="update_branche_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_branche_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_branche_options</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">monat</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the industry filter options based on other selected filters.</span>

<span class="sd">    The list of industries is predefined based on an analysis of the existing dataset.</span>
<span class="sd">    Only industries present in the currently filtered dataset will be made available in the dropdown.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        monat (list or None): Selected months in &#39;YYYY-MM&#39; format.</span>
<span class="sd">        position (list or None): Selected job positions.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company size categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available industry/category options for the dropdown,</span>
<span class="sd">              where each dictionary contains &#39;label&#39; and &#39;value&#39; keys with the industry name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a full copy of the dataset</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply filters based on current selections</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">monat</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monat</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="c1"># Extract unique, non-null industry names and sort them</span>
    <span class="n">verfuegbare_branchen</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># Create dropdown option list with industry names</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">branche</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">branche</span><span class="p">}</span> <span class="k">for</span> <span class="n">branche</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_branchen</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback to update the available job position filter options based on current filter selections</span>
<div class="viewcode-block" id="update_position_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_position_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_position_options</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">monat</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the job position filter options based on other selected filters.</span>

<span class="sd">    Job positions are shown only if they exist within the current filter selection.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        monat (list or None): Selected months in &#39;YYYY-MM&#39; format.</span>
<span class="sd">        branche (list or None): Selected industries/categories.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company size categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available job position options for the dropdown,</span>
<span class="sd">              each containing &#39;label&#39; and &#39;value&#39; keys with the position name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with a full copy of the dataset</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply filters based on current selections</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">monat</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monat</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>

    <span class="c1"># Extract unique, non-null job positions and sort them</span>
    <span class="n">verfuegbare_positionen</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># Create dropdown option list with job position names</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">position</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">position</span><span class="p">}</span> <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_positionen</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback to update the company size filter options based on current filter selections</span>
<div class="viewcode-block" id="update_unternehmensgroesse_options">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_unternehmensgroesse_options">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_unternehmensgroesse_options</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">monat</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dynamically updates the available company size options based on other selected filters.</span>

<span class="sd">    Displayed company sizes are limited to those included in the active dataset view.</span>

<span class="sd">    To maintain a consistent and intuitive user experience, the returned company size options</span>
<span class="sd">    follow a predefined logical order - from smallest to largest company sizes - excluding null or non-occurring values in the current filter context.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        monat (list or None): Selected months in &#39;YYYY-MM&#39; format.</span>
<span class="sd">        branche (list or None): Selected industries/categories.</span>
<span class="sd">        position (list or None): Selected job positions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries with available company size options for the dropdown,</span>
<span class="sd">              each containing &#39;label&#39; and &#39;value&#39; keys with the company size name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with full dataset copy</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Apply filters based on current selections</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">monat</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monat</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>

    <span class="c1"># Get unique, non-null company sizes from filtered data</span>
    <span class="n">vorhandene_groessen</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="c1"># Keep only company sizes that exist in the filtered data,</span>
    <span class="c1"># preserving the predefined order in unternehmensgroessen_sortiert</span>
    <span class="n">unternehmensgroessen</span> <span class="o">=</span> <span class="p">[</span><span class="n">groesse</span> <span class="k">for</span> <span class="n">groesse</span> <span class="ow">in</span> <span class="n">unternehmensgroessen_sortiert</span> <span class="k">if</span> <span class="n">groesse</span> <span class="ow">in</span> <span class="n">vorhandene_groessen</span><span class="p">]</span>
    <span class="c1"># Create dropdown option list</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">groesse</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">groesse</span><span class="p">}</span> <span class="k">for</span> <span class="n">groesse</span> <span class="ow">in</span> <span class="n">unternehmensgroessen</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callbacks &quot;Vergleich der Stellenanzeigen&quot;</span>
<span class="c1"># Callback for the comparison dashboard</span>
<div class="viewcode-block" id="aktualisiere_verguetungen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.aktualisiere_verguetungen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;verguetungen-balken-links&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;verguetungen-balken-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;titel-links&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;titel-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-position&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>  <span class="c1"># Hinzugefügt</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-links&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-links&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">aktualisiere_verguetungen</span><span class="p">(</span><span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span> <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span>
                              <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">,</span> <span class="n">job_titel_links</span><span class="p">,</span> <span class="n">unternehmen_links</span><span class="p">,</span> <span class="n">job_titel_rechts</span><span class="p">,</span>
                              <span class="n">unternehmen_rechts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the job advertisement comparison section (&quot;Vergleich der Stellenanzeigen&quot;) of the dashboard based on selected filters.</span>

<span class="sd">    This callback processes user-defined filter selections to dynamically generate two side-by-side</span>
<span class="sd">    bar charts, each representing attributes from three predefined compensation-related categories</span>
<span class="sd">    for different job titles or companies.</span>

<span class="sd">    The function proceeds in several steps:</span>

<span class="sd">    1. **Column preparation**:</span>
<span class="sd">       It first checks which categories (financial compensation, benefits, and workplace environment)</span>
<span class="sd">       are available in the dataset to avoid referencing missing data.</span>

<span class="sd">    2. **Label mapping**:</span>
<span class="sd">       Technical column names are mapped to readable, user-facing labels for display in the charts.</span>

<span class="sd">    3. **Data filtering (left and right)**:</span>
<span class="sd">       The dataset is filtered independently for the left and right views using the same filter set.</span>
<span class="sd">       This enables the comparison of two targeted market segments.</span>

<span class="sd">    4. **Deduplication**:</span>
<span class="sd">       Duplicate job advertisements are removed using a unique identifier (`MongoDB_ID`) to ensure</span>
<span class="sd">       accurate visualizations and counts.</span>

<span class="sd">    5. **Job count calculation**:</span>
<span class="sd">       For both sides, the number of unique advertisements is calculated and included in the chart titles.</span>

<span class="sd">    The comparison is visualized using bar charts, which were selected for their clarity in presenting</span>
<span class="sd">    categorical data. This format allows for intuitive side-by-side comparison and supports a clear visual representation of differences between the two selected job titles or companies.</span>

<span class="sd">    Internally, the function contains a dedicated helper function that generates the individual bar charts.</span>
<span class="sd">    This helper handles several specific aspects of the visualization:</span>

<span class="sd">    - **Percentage calculation**:</span>
<span class="sd">      Compensation attributes are expressed as percentages of the total number of matching job advertisements,</span>
<span class="sd">      rather than absolute counts. This approach was implemented in consultation with the supervisors and PwC,</span>
<span class="sd">      as it enables more meaningful comparisons between groups of different sizes.</span>

<span class="sd">    - **Exclusion of zero values**:</span>
<span class="sd">      Attributes with 0% occurrence are excluded from the chart to avoid clutter and improve readability.</span>

<span class="sd">    - **Fallback logic**:</span>
<span class="sd">      If no data matches the selected filter criteria, a placeholder chart is rendered to indicate the absence of results.</span>

<span class="sd">    - **Color scheme by category**:</span>
<span class="sd">      Each compensation category (financial, work environment, additional benefits) is represented using a specific</span>
<span class="sd">      color from the official PwC color palette to ensure visual consistency with corporate branding.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_portal (list or None): Selected job portals.</span>
<span class="sd">        bundesland (list or None): Selected federal states.</span>
<span class="sd">        beschaeftigungsart (str or None): Selected type of employment (converted internally).</span>
<span class="sd">        position (list or None): Selected job positions.</span>
<span class="sd">        zeitmodell (str or None): Selected working time model.</span>
<span class="sd">        berufserfahrung (int or None): Required professional experience.</span>
<span class="sd">        monate (list or None): Selected months in &#39;YYYY-MM&#39; format.</span>
<span class="sd">        unternehmensgroesse (list or None): Selected company sizes.</span>
<span class="sd">        branche (list or None): Selected industries.</span>
<span class="sd">        job_titel_links (str or None): Selected job title for left comparison.</span>
<span class="sd">        unternehmen_links (str or None): Selected company for left comparison.</span>
<span class="sd">        job_titel_rechts (str or None): Selected job title for right comparison.</span>
<span class="sd">        unternehmen_rechts (str or None): Selected company for right comparison.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:</span>
<span class="sd">            - figure: Left compensation bar chart figure.</span>
<span class="sd">            - figure: Right compensation bar chart figure.</span>
<span class="sd">            - str: Title text for the left side.</span>
<span class="sd">            - str: Title text for the right side.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Use only existing columns in the dataframe</span>
    <span class="n">vorhandene_spalten</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Define categories with filtering on existing columns</span>
    <span class="n">finanzielle_spalten</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s1">&#39;Gehalt_anhand_von_Tarifklassen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Überstundenvergütung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Gehaltserhöhungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Aktienoptionen_Gewinnbeteiligung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Boni&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sonderzahlungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;13. Gehalt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Betriebliche_Altersvorsorge&#39;</span>
    <span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">vorhandene_spalten</span><span class="p">]</span>

    <span class="n">arbeitsumfeld_spalten</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s1">&#39;Flexible_Arbeitsmodelle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Homeoffice&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Arbeitsumfeld_Ausstattung&#39;</span>
    <span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">vorhandene_spalten</span><span class="p">]</span>

    <span class="n">zusatzleistungen_spalten</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s1">&#39;Weiterbildung_und_Entwicklungsmöglichkeiten&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Gesundheit_und_Wohlbefinden&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Finanzielle_Vergünstigungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mobilitätsangebote&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Verpflegung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Zusätzliche_Urlaubstage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Familien_Unterstützung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Onboarding_und_Mentoring_Programme&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Teamevents_Firmenfeiern&#39;</span>
    <span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">vorhandene_spalten</span><span class="p">]</span>

    <span class="c1"># Rreadable labels for compensation types</span>
    <span class="n">verguetungs_labels</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Gehalt_anhand_von_Tarifklassen&#39;</span><span class="p">:</span> <span class="s1">&#39;Gehalt nach Tarifklassen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Überstundenvergütung&#39;</span><span class="p">:</span> <span class="s1">&#39;Überstundenvergütung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Gehaltserhöhungen&#39;</span><span class="p">:</span> <span class="s1">&#39;Gehaltserhöhungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Aktienoptionen_Gewinnbeteiligung&#39;</span><span class="p">:</span> <span class="s1">&#39;Aktienoptionen/Gewinnbeteiligung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Boni&#39;</span><span class="p">:</span> <span class="s1">&#39;Boni&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sonderzahlungen&#39;</span><span class="p">:</span> <span class="s1">&#39;Sonderzahlungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;13. Gehalt&#39;</span><span class="p">:</span> <span class="s1">&#39;13. Gehalt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Betriebliche_Altersvorsorge&#39;</span><span class="p">:</span> <span class="s1">&#39;Betriebliche Altersvorsorge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Flexible_Arbeitsmodelle&#39;</span><span class="p">:</span> <span class="s1">&#39;Flexible Arbeitsmodelle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Homeoffice&#39;</span><span class="p">:</span> <span class="s1">&#39;Homeoffice&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Arbeitsumfeld_Ausstattung&#39;</span><span class="p">:</span> <span class="s1">&#39;Arbeitsumfeld Ausstattung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Weiterbildung_und_Entwicklungsmöglichkeiten&#39;</span><span class="p">:</span> <span class="s1">&#39;Weiterbildung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Gesundheit_und_Wohlbefinden&#39;</span><span class="p">:</span> <span class="s1">&#39;Gesundheit &amp; Wohlbefinden&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Finanzielle_Vergünstigungen&#39;</span><span class="p">:</span> <span class="s1">&#39;Finanzielle Vergünstigungen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mobilitätsangebote&#39;</span><span class="p">:</span> <span class="s1">&#39;Mobilitätsangebote&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Verpflegung&#39;</span><span class="p">:</span> <span class="s1">&#39;Verpflegung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Zusätzliche_Urlaubstage&#39;</span><span class="p">:</span> <span class="s1">&#39;Zusätzliche Urlaubstage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Familien_Unterstützung&#39;</span><span class="p">:</span> <span class="s1">&#39;Familienunterstützung&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Onboarding_und_Mentoring_Programme&#39;</span><span class="p">:</span> <span class="s1">&#39;Onboarding/Mentoring&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Teamevents_Firmenfeiern&#39;</span><span class="p">:</span> <span class="s1">&#39;Teamevents/Firmenfeiern&#39;</span>
    <span class="p">}</span>

    <span class="c1"># Filter data for left side</span>
    <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="c1"># Convert string to list for filtering</span>
        <span class="n">beschaeftigungsarten</span> <span class="o">=</span> <span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsarten</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">job_titel_links</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job_titel_links</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">unternehmen_links</span><span class="p">:</span>
        <span class="n">gefiltert_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="p">[</span><span class="n">gefiltert_links</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">unternehmen_links</span><span class="p">]</span>

    <span class="c1"># Filter data for right side</span>
    <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="c1"># Convert string to list for filtering</span>
        <span class="n">beschaeftigungsarten</span> <span class="o">=</span> <span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsarten</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">position</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Position&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">position</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">job_titel_rechts</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job_titel_rechts</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">unternehmen_rechts</span><span class="p">:</span>
        <span class="n">gefiltert_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="p">[</span><span class="n">gefiltert_rechts</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">unternehmen_rechts</span><span class="p">]</span>

    <span class="c1"># Remove duplicates based on MongoDB_ID for counting</span>
    <span class="n">eindeutige_links</span> <span class="o">=</span> <span class="n">gefiltert_links</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MongoDB_ID&#39;</span><span class="p">])</span>
    <span class="n">eindeutige_rechts</span> <span class="o">=</span> <span class="n">gefiltert_rechts</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MongoDB_ID&#39;</span><span class="p">])</span>

    <span class="n">anzahl_links</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eindeutige_links</span><span class="p">)</span>
    <span class="n">anzahl_rechts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eindeutige_rechts</span><span class="p">)</span>

    <span class="c1"># Create titles for both sides</span>
    <span class="n">titel_links</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Betrifft hier </span><span class="si">{</span><span class="n">anzahl_links</span><span class="si">}</span><span class="s2"> Jobs&quot;</span>
    <span class="n">titel_rechts</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Betrifft hier </span><span class="si">{</span><span class="n">anzahl_rechts</span><span class="si">}</span><span class="s2"> Jobs&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">erstelle_verguetungen_figur</span><span class="p">(</span><span class="n">daten</span><span class="p">,</span> <span class="n">anzahl</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to create a horizontal bar chart for compensation types.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        - daten: filtered DataFrame to use for the plot</span>
<span class="sd">        - anzahl: total number of unique jobs in the filtered data for percentage calculation</span>

<span class="sd">        Returns:</span>
<span class="sd">        - Plotly figure object representing the bar chart</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove duplicates for consistent calculation</span>
        <span class="n">eindeutige_daten</span> <span class="o">=</span> <span class="n">daten</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MongoDB_ID&#39;</span><span class="p">])</span>

        <span class="c1"># List for all category data</span>
        <span class="n">alle_kategorien_daten</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># 1. Process financial compensations</span>
        <span class="k">if</span> <span class="n">finanzielle_spalten</span><span class="p">:</span>
            <span class="n">finanzielle_daten</span> <span class="o">=</span> <span class="n">eindeutige_daten</span><span class="p">[</span><span class="n">finanzielle_spalten</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">finanzielle_daten</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span>
            <span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">anzahl</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Finanzielle Vergütung&#39;</span>
            <span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">verguetungs_labels</span><span class="p">)</span>
            <span class="c1"># Filter out zero values</span>
            <span class="n">finanzielle_daten</span> <span class="o">=</span> <span class="n">finanzielle_daten</span><span class="p">[</span><span class="n">finanzielle_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">alle_kategorien_daten</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">finanzielle_daten</span><span class="p">)</span>

        <span class="c1"># 2. Process work environment</span>
        <span class="k">if</span> <span class="n">arbeitsumfeld_spalten</span><span class="p">:</span>
            <span class="n">arbeitsumfeld_daten</span> <span class="o">=</span> <span class="n">eindeutige_daten</span><span class="p">[</span><span class="n">arbeitsumfeld_spalten</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">arbeitsumfeld_daten</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span>
            <span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">anzahl</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arbeitsumfeld&#39;</span>
            <span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">verguetungs_labels</span><span class="p">)</span>
            <span class="c1"># Filter out zero values</span>
            <span class="n">arbeitsumfeld_daten</span> <span class="o">=</span> <span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="n">arbeitsumfeld_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">alle_kategorien_daten</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arbeitsumfeld_daten</span><span class="p">)</span>

        <span class="c1"># 3. Process additional benefits</span>
        <span class="k">if</span> <span class="n">zusatzleistungen_spalten</span><span class="p">:</span>
            <span class="n">zusatzleistungen_daten</span> <span class="o">=</span> <span class="n">eindeutige_daten</span><span class="p">[</span><span class="n">zusatzleistungen_spalten</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">zusatzleistungen_daten</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span>
            <span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">anzahl</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Zusatzleistungen&#39;</span>
            <span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">verguetungs_labels</span><span class="p">)</span>
            <span class="c1"># Filter out zero values</span>
            <span class="n">zusatzleistungen_daten</span> <span class="o">=</span> <span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="n">zusatzleistungen_daten</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">alle_kategorien_daten</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zusatzleistungen_daten</span><span class="p">)</span>

        <span class="c1"># Combine all categories into one DataFrame</span>
        <span class="k">if</span> <span class="n">alle_kategorien_daten</span><span class="p">:</span>
            <span class="n">kombiniert</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">alle_kategorien_daten</span><span class="p">)</span>
            <span class="n">kombiniert</span> <span class="o">=</span> <span class="n">kombiniert</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Fallback: Create empty DataFrame</span>
            <span class="n">kombiniert</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span> <span class="s1">&#39;Kategorie&#39;</span><span class="p">])</span>

        <span class="c1"># Define color mapping for each category</span>
        <span class="n">farben</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;Finanzielle Vergütung&#39;</span><span class="p">:</span> <span class="n">COLOR_1</span><span class="p">,</span>
            <span class="s1">&#39;Arbeitsumfeld&#39;</span><span class="p">:</span> <span class="n">COLOR_5</span><span class="p">,</span>
            <span class="s1">&#39;Zusatzleistungen&#39;</span><span class="p">:</span> <span class="n">COLOR_4</span>
        <span class="p">}</span>

        <span class="c1"># Create the bar chart (only if data is available)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kombiniert</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">figur</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                <span class="n">kombiniert</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">,</span>
                <span class="n">color_discrete_map</span><span class="o">=</span><span class="n">farben</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">{</span>
                    <span class="s1">&#39;Anzahl&#39;</span><span class="p">:</span> <span class="s1">&#39;Anteil der Jobs (%)&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Vergütungsart&#39;</span><span class="p">:</span> <span class="s1">&#39;Art der Vergütung&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Kategorie&#39;</span><span class="p">:</span> <span class="s1">&#39;Kategorie&#39;</span>
                <span class="p">},</span>
                <span class="n">category_orders</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Vergütungsart&quot;</span><span class="p">:</span> <span class="n">kombiniert</span><span class="p">[</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()},</span>
                <span class="n">text</span><span class="o">=</span><span class="n">kombiniert</span><span class="p">[</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create empty placeholder chart if no data is available</span>
            <span class="n">figur</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Keine Daten&#39;</span><span class="p">],</span> <span class="s1">&#39;Anzahl&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}),</span>
                <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Vergütungsart&#39;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Anzahl&#39;</span><span class="p">,</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span>
            <span class="p">)</span>
        <span class="c1"># Update trace styling</span>
        <span class="n">figur</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">textfont_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
            <span class="n">cliponaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span>
        <span class="p">)</span>
        <span class="c1"># Update layout for better readability and formatting</span>
        <span class="n">figur</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;categoryorder&#39;</span><span class="p">:</span> <span class="s1">&#39;total ascending&#39;</span><span class="p">},</span>
            <span class="n">margin</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>  <span class="c1"># Add top margin for legend spacing</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;Kategorien&#39;</span><span class="p">,</span>
            <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;#E5ECF6&#39;</span><span class="p">,</span>
            <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Anteil der Jobs (%)&#39;</span><span class="p">,</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">gridcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="n">uniformtext_minsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">uniformtext_mode</span><span class="o">=</span><span class="s1">&#39;hide&#39;</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>      <span class="c1"># Horizontal layout</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>     <span class="c1"># Anchor at bottom</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span>               <span class="c1"># Slightly above the plot</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>     <span class="c1"># Center aligned</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>                <span class="c1"># Position in the middle</span>
                <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;rgba(255,255,255,0.5)&#39;</span><span class="p">,</span>  <span class="c1"># Semi-transparent background</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">figur</span>

    <span class="c1"># Use filtered datasets (with duplicates removed) to generate bar charts</span>
    <span class="n">figur_links</span> <span class="o">=</span> <span class="n">erstelle_verguetungen_figur</span><span class="p">(</span><span class="n">gefiltert_links</span><span class="p">,</span> <span class="n">anzahl_links</span><span class="p">)</span>
    <span class="n">figur_rechts</span> <span class="o">=</span> <span class="n">erstelle_verguetungen_figur</span><span class="p">(</span><span class="n">gefiltert_rechts</span><span class="p">,</span> <span class="n">anzahl_rechts</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">figur_links</span><span class="p">,</span> <span class="n">figur_rechts</span><span class="p">,</span> <span class="n">titel_links</span><span class="p">,</span> <span class="n">titel_rechts</span></div>



<span class="c1"># Callback for the left side</span>
<div class="viewcode-block" id="update_unternehmen_links">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_unternehmen_links">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-links&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-links&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_unternehmen_links</span><span class="p">(</span><span class="n">job_titel</span><span class="p">,</span> <span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span>
                              <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the list of available companies in the dropdown menu on the left side of the</span>
<span class="sd">    &quot;Vergleich der Stellenanzeigen&quot; section of the dashboard.</span>

<span class="sd">    The update is based on both the global filter selections and the selected job title for the left comparison view.</span>

<span class="sd">    This ensures that the dropdown only displays companies relevant to the specific combination</span>
<span class="sd">    of filters currently applied by the user.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_titel (str): Selected job title.</span>
<span class="sd">        job_portal (list): List of selected job portals.</span>
<span class="sd">        bundesland (list): List of selected federal states.</span>
<span class="sd">        beschaeftigungsart (str): Selected type of employment.</span>
<span class="sd">        zeitmodell (str): Selected work time model.</span>
<span class="sd">        berufserfahrung (bool): Whether professional experience is required.</span>
<span class="sd">        monate (list): List of selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        unternehmensgroesse (list): List of selected company sizes.</span>
<span class="sd">        branche (list): List of selected industry categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of dictionaries with &#39;label&#39; and &#39;value&#39; for each available company.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a copy of the dataset to apply filters</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span>
            <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[]))]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">job_titel</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job_titel</span><span class="p">]</span>

    <span class="c1"># Extract available companies</span>
    <span class="n">verfuegbare_unternehmen</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Create options for dropdown</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">unternehmen</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">unternehmen</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">unternehmen</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_unternehmen</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">unternehmen</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback for the right side</span>
<div class="viewcode-block" id="update_unternehmen_rechts">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_unternehmen_rechts">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_unternehmen_rechts</span><span class="p">(</span><span class="n">job_titel</span><span class="p">,</span> <span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span>
                               <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the list of available companies in the dropdown menu on the right side of the</span>
<span class="sd">    &quot;Vergleich der Stellenanzeigen&quot; section of the dashboard.</span>

<span class="sd">    The update is based on both the global filter selections and the selected job title for the right comparison view.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        job_titel (str): Selected job title.</span>
<span class="sd">        job_portal (list): List of selected job portals.</span>
<span class="sd">        bundesland (list): List of selected federal states.</span>
<span class="sd">        beschaeftigungsart (str): Selected type of employment.</span>
<span class="sd">        zeitmodell (str): Selected work time model.</span>
<span class="sd">        berufserfahrung (bool): Whether professional experience is required.</span>
<span class="sd">        monate (list): List of selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        unternehmensgroesse (list): List of selected company sizes.</span>
<span class="sd">        branche (list): List of selected industry categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of dictionaries with &#39;label&#39; and &#39;value&#39; for each available company.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a copy of the dataset to apply filters</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span>
            <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[]))]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">job_titel</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">job_titel</span><span class="p">]</span>

    <span class="c1"># Extract available companies</span>
    <span class="n">verfuegbare_unternehmen</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Create options for dropdown</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">unternehmen</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">unternehmen</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">unternehmen</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_unternehmen</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">unternehmen</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback for the job title filter on the left side (filters by company and global filters)</span>
<div class="viewcode-block" id="update_job_titel_links">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_job_titel_links">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-links&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-links&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_job_titel_links</span><span class="p">(</span><span class="n">unternehmen</span><span class="p">,</span> <span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span>
                           <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the list of available job titles in the dropdown menu on the left side of the</span>
<span class="sd">    &quot;Vergleich der Stellenanzeigen&quot; section of the dashboard.</span>

<span class="sd">    The update is based on both the global filter selections and the optionally selected company</span>
<span class="sd">    for the left comparison view.</span>

<span class="sd">    This ensures that the dropdown only displays job titles relevant to the specific combination</span>
<span class="sd">    of filters currently applied by the user.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        unternehmen (str): Selected company.</span>
<span class="sd">        job_portal (list): List of selected job portals.</span>
<span class="sd">        bundesland (list): List of selected federal states.</span>
<span class="sd">        beschaeftigungsart (str): Selected type of employment.</span>
<span class="sd">        zeitmodell (str): Selected work time model.</span>
<span class="sd">        berufserfahrung (bool): Whether professional experience is required.</span>
<span class="sd">        monate (list): List of selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        unternehmensgroesse (list): List of selected company sizes.</span>
<span class="sd">        branche (list): List of selected industry categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of dictionaries with &#39;label&#39; and &#39;value&#39; for each available job title.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a copy of the dataset to apply filters</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span>
            <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[]))]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmen</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">unternehmen</span><span class="p">]</span>

    <span class="c1"># Extract available job titles</span>
    <span class="n">verfuegbare_job_titel</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Create options for dropdown</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">job_titel</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">job_titel</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">job_titel</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_job_titel</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">job_titel</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Callback for the job title filter on the right side (filters by company and global filters)</span>
<div class="viewcode-block" id="update_job_titel_rechts">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.update_job_titel_rechts">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-job-titel-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmen-rechts&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-job-portal&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-bundesland&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-beschaeftigungsart&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-zeitmodell&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-berufserfahrung&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-monat&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-unternehmensgroesse&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;filter-branche&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_job_titel_rechts</span><span class="p">(</span><span class="n">unternehmen</span><span class="p">,</span> <span class="n">job_portal</span><span class="p">,</span> <span class="n">bundesland</span><span class="p">,</span> <span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="n">zeitmodell</span><span class="p">,</span>
                            <span class="n">berufserfahrung</span><span class="p">,</span> <span class="n">monate</span><span class="p">,</span> <span class="n">unternehmensgroesse</span><span class="p">,</span> <span class="n">branche</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the list of available job titles in the dropdown menu on the right side of the</span>
<span class="sd">    &quot;Vergleich der Stellenanzeigen&quot; section of the dashboard.</span>

<span class="sd">    The update is based on both the global filter selections and the optionally selected company</span>
<span class="sd">    for the right comparison view.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        unternehmen (str): Selected company.</span>
<span class="sd">        job_portal (list): List of selected job portals.</span>
<span class="sd">        bundesland (list): List of selected federal states.</span>
<span class="sd">        beschaeftigungsart (str): Selected type of employment.</span>
<span class="sd">        zeitmodell (str): Selected work time model.</span>
<span class="sd">        berufserfahrung (bool): Whether professional experience is required.</span>
<span class="sd">        monate (list): List of selected months (format &#39;YYYY-MM&#39;).</span>
<span class="sd">        unternehmensgroesse (list): List of selected company sizes.</span>
<span class="sd">        branche (list): List of selected industry categories.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of dictionaries with &#39;label&#39; and &#39;value&#39; for each available job title.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a copy of the dataset to apply filters</span>
    <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">datenrahmen</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">job_portal</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Portal_Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">job_portal</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">bundesland</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Bundesland&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bundesland</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">beschaeftigungsart</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span>
            <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Beschäftigungsart&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">beschaeftigungsart_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">beschaeftigungsart</span><span class="p">,</span> <span class="p">[]))]</span>
    <span class="k">if</span> <span class="n">zeitmodell</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Zeitmodell&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">zeitmodell</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">berufserfahrung</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Berufserfahrung_vorausgesetzt&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">berufserfahrung</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">monate</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Datum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">monate</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmensgroesse</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmensgröße&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">unternehmensgroesse</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">branche</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Kategorie&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">branche</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">unternehmen</span><span class="p">:</span>
        <span class="n">gefiltert</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Unternehmen&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">unternehmen</span><span class="p">]</span>

    <span class="c1"># Extract available job titles</span>
    <span class="n">verfuegbare_job_titel</span> <span class="o">=</span> <span class="n">gefiltert</span><span class="p">[</span><span class="s1">&#39;Job_Titel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Create dropdown options</span>
    <span class="n">optionen</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="n">job_titel</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">job_titel</span><span class="p">}</span>
                <span class="k">for</span> <span class="n">job_titel</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verfuegbare_job_titel</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">job_titel</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">optionen</span></div>



<span class="c1"># Admin-Section Callbacks</span>
<span class="c1"># Callback to add a new job title by pressing Enter</span>
<div class="viewcode-block" id="jobtitel_hinzufuegen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.jobtitel_hinzufuegen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;jobtitel-eingabe&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;jobtitel-eingabe&#39;</span><span class="p">,</span> <span class="s1">&#39;n_submit&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;jobtitel-eingabe&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">),</span>
     <span class="n">State</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">jobtitel_hinzufuegen</span><span class="p">(</span><span class="n">n_submit</span><span class="p">,</span> <span class="n">neuer_jobtitel</span><span class="p">,</span> <span class="n">aktuelle_liste</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds a new job title to the temporary list when the user presses Enter in the input field.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_submit (int): Triggered when the Enter key is pressed in the input field.</span>
<span class="sd">        neuer_jobtitel (str): The new job title entered by the user.</span>
<span class="sd">        aktuelle_liste (list): The current temporary list of job titles.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Updated list of job titles if the new entry is valid and not a duplicate.</span>
<span class="sd">        str: Clears the input field after a valid submission.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if Enter was pressed, and the input is not empty</span>
    <span class="k">if</span> <span class="n">n_submit</span> <span class="ow">and</span> <span class="n">neuer_jobtitel</span> <span class="ow">and</span> <span class="n">neuer_jobtitel</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="c1"># Avoid adding duplicates</span>
        <span class="k">if</span> <span class="n">neuer_jobtitel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">aktuelle_liste</span><span class="p">:</span>
            <span class="n">aktuelle_liste</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neuer_jobtitel</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">aktuelle_liste</span><span class="p">,</span> <span class="s2">&quot;&quot;</span> <span class="c1"># Clear input field after adding</span>
    <span class="k">return</span> <span class="n">no_update</span><span class="p">,</span> <span class="n">no_update</span> <span class="c1"># Do nothing if input is invalid or duplicate</span></div>



<span class="c1"># Callback to update the list of job titles in the admin interface</span>
<div class="viewcode-block" id="jobtitel_liste_aktualisieren">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.jobtitel_liste_aktualisieren">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;jobtitel-liste-container&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">jobtitel_liste_aktualisieren</span><span class="p">(</span><span class="n">jobtitel_liste</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the visual list of job titles based on the current temporary storage.</span>

<span class="sd">    This function generates a list of rows, each containing a job title and an associated delete button.</span>
<span class="sd">    The delete buttons use Dash pattern-matching IDs to support dynamic interaction.</span>

<span class="sd">    If the list is empty, a placeholder message is displayed instead.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        jobtitel_liste (list): A list of job titles stored temporarily.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of html.Div: A list of rows containing job titles and corresponding delete buttons.</span>
<span class="sd">                          If the list is empty, a message is shown instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If no job titles are present, display a placeholder message</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">jobtitel_liste</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="s2">&quot;Keine Job-Titel vorhanden.&quot;</span><span class="p">)</span>

    <span class="n">zeilen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Generate one row per job title with a delete button</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">jobtitel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">jobtitel_liste</span><span class="p">):</span>
        <span class="n">zeile</span> <span class="o">=</span> <span class="n">dbc</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">(</span><span class="n">jobtitel</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="c1"># Display job title text</span>
                <span class="n">dbc</span><span class="o">.</span><span class="n">Col</span><span class="p">(</span>
                    <span class="n">dbc</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                        <span class="n">html</span><span class="o">.</span><span class="n">I</span><span class="p">(</span><span class="n">className</span><span class="o">=</span><span class="s2">&quot;fas fa-trash&quot;</span><span class="p">),</span> <span class="c1"># Trash icon</span>
                        <span class="nb">id</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;jobtitel-loeschen&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">index</span><span class="p">},</span> <span class="c1"># Pattern-matching ID</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;link&quot;</span><span class="p">,</span>
                        <span class="n">className</span><span class="o">=</span><span class="s2">&quot;p-0&quot;</span>
                    <span class="p">),</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">className</span><span class="o">=</span><span class="s2">&quot;text-end&quot;</span> <span class="c1"># Align delete button to the right</span>
                <span class="p">)</span>
            <span class="p">],</span>
            <span class="n">className</span><span class="o">=</span><span class="s2">&quot;border-bottom py-2&quot;</span> <span class="c1"># Row styling</span>
        <span class="p">)</span>
        <span class="n">zeilen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zeile</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">zeilen</span></div>



<span class="c1"># Callback to delete individual job titles from the temporary list</span>
<div class="viewcode-block" id="jobtitel_loeschen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.jobtitel_loeschen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;jobtitel-loeschen&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">ALL</span><span class="p">},</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">jobtitel_loeschen</span><span class="p">(</span><span class="n">clicks</span><span class="p">,</span> <span class="n">jobtitel_liste</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deletes a specific job title from the temporary job title list when its corresponding delete button is clicked.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        clicks (list): List of click counts from dynamically generated delete buttons.</span>
<span class="sd">        jobtitel_liste (list): The current list of job titles stored temporarily.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The updated job title list with the selected entry removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If no delete buttons were clicked, do nothing</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">clicks</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">no_update</span>

    <span class="c1"># Get information about which button triggered the callback</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">callback_context</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">no_update</span>

    <span class="c1"># Extract the index of the button that was clicked</span>
    <span class="n">button_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">button_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>

    <span class="c1"># Remove the job title at the given index</span>
    <span class="n">neue_liste</span> <span class="o">=</span> <span class="n">jobtitel_liste</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">neue_liste</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">neue_liste</span></div>



<span class="c1"># Callback to control the visibility of the confirmation modal for clearing the job title list</span>
<div class="viewcode-block" id="steuere_loeschen_modal">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.steuere_loeschen_modal">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;bestätigen-liste-leeren-modal&#39;</span><span class="p">,</span> <span class="s1">&#39;is_open&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;liste-leeren&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;bestätigen-liste-leeren-ja&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;bestätigen-liste-leeren-nein&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">steuere_loeschen_modal</span><span class="p">(</span><span class="n">open_clicks</span><span class="p">,</span> <span class="n">confirm_clicks</span><span class="p">,</span> <span class="n">cancel_clicks</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the visibility of the confirmation modal that appears when the user attempts to clear</span>
<span class="sd">    the job title list in the dashboard&#39;s admin section.</span>

<span class="sd">    This callback determines whether the modal should be shown or hidden, based on which button</span>
<span class="sd">    triggered the action. It listens to three buttons: the initial &quot;Job Titel Liste leeren&quot; button, the</span>
<span class="sd">    &quot;Ja, alle entfernen&quot; (Yes) button inside the modal, and the &quot;Abbrechen&quot; (No) button.</span>

<span class="sd">    - If the user clicks the &quot;Job Titel Liste leeren&quot; button, the modal is opened.</span>
<span class="sd">    - If the user clicks either &quot;Yes&quot; or &quot;No&quot; inside the modal, it is closed.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        open_clicks (int): Clicks on the &quot;clear list&quot; button.</span>
<span class="sd">        confirm_clicks (int): Clicks on the confirmation (&quot;Yes&quot;) button inside the modal.</span>
<span class="sd">        cancel_clicks (int): Clicks on the cancel (&quot;No&quot;) button inside the modal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the modal should be opened, False if it should be closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the ID of the button that triggered the callback</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">callback_context</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">no_update</span>

    <span class="n">button_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Open modal if &quot;clear list&quot; button was clicked</span>
    <span class="k">if</span> <span class="n">button_id</span> <span class="o">==</span> <span class="s1">&#39;liste-leeren&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="c1"># Close modal if either &quot;Yes&quot; or &quot;No&quot; button was clicked</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span></div>



<span class="c1"># Callback to delete all job titles when confirmed via the modal</span>
<div class="viewcode-block" id="alle_jobtitel_loeschen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.alle_jobtitel_loeschen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;bestätigen-liste-leeren-ja&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">alle_jobtitel_loeschen</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears all job titles from the temporary storage when the user confirms the action in the modal.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_clicks (int): Number of clicks on the confirmation (&quot;Yes&quot;) button.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list or no_update: An empty list to clear the job title storage or no_update if no action is needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If the &quot;Yes&quot; button was clicked, clear the list</span>
    <span class="k">if</span> <span class="n">n_clicks</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">no_update</span></div>



<span class="c1"># Callback to upload the job title list to MongoDB when button is clicked</span>
<div class="viewcode-block" id="jobtitel_hochladen">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.jobtitel_hochladen">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;erfolg-modal&#39;</span><span class="p">,</span> <span class="s1">&#39;is_open&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;liste-hochladen&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;jobtitel-temp-speicher&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">jobtitel_hochladen</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">jobtitel_liste</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads the current job title list to MongoDB when the upload button is clicked,</span>
<span class="sd">    and opens a confirmation modal upon success.</span>

<span class="sd">    This callback is triggered by the user clicking the &quot;Liste der Job Titel hochladen&quot; button. It performs two actions:</span>

<span class="sd">    1. Saves the current job title list locally using a predefined helper function.</span>
<span class="sd">    2. Attempts to upload the list to MongoDB via a dedicated database interface function.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_clicks (int): Number of clicks on the upload button.</span>
<span class="sd">        jobtitel_liste (list): The current list of job titles stored temporarily.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True to open the success modal, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Trigger upload only if button was clicked</span>
    <span class="k">if</span> <span class="n">n_clicks</span><span class="p">:</span>
        <span class="c1"># Save job titles locally</span>
        <span class="n">save_job_titles</span><span class="p">(</span><span class="n">jobtitel_liste</span><span class="p">)</span>

        <span class="c1"># Try uploading to MongoDB</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">MongoDB</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_job_titles_to_mongodb</span>
            <span class="k">if</span> <span class="n">upload_job_titles_to_mongodb</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Erfolgreich in MongoDB hochgeladen!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MongoDB-Upload fehlgeschlagen!&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kritischer MongoDB-Fehler: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Open the success modal</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Do not open modal if no click</span>
    <span class="k">return</span> <span class="kc">False</span></div>



<span class="c1"># Callback to close the success modal when the close button is clicked</span>
<div class="viewcode-block" id="schliesse_erfolgsmodal">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.schliesse_erfolgsmodal">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;erfolg-modal&#39;</span><span class="p">,</span> <span class="s1">&#39;is_open&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;erfolg-modal-schliessen&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">schliesse_erfolgsmodal</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Closes the success modal when the user clicks the close button.</span>

<span class="sd">    The modal can be closed either via the &quot;X&quot; icon in the upper corner or via the &quot;Schließen&quot; button within the modal.</span>

<span class="sd">    If no interaction occurs, the modal remains unchanged.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        n_clicks (int): Number of clicks on the modal close button.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool or no_update: Returns False to close the modal, or no_update if no clicks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Close modal only if button was clicked</span>
    <span class="k">if</span> <span class="n">n_clicks</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Otherwise, do not update modal state</span>
    <span class="k">return</span> <span class="n">no_update</span></div>



<span class="c1"># Callback to hide the left filter column when the Admin area is active</span>
<div class="viewcode-block" id="steuere_layout_und_filter">
<a class="viewcode-back" href="../../dashboard.html#src.dashboard.steuere_layout_und_filter">[docs]</a>
<span class="nd">@app</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Output</span><span class="p">(</span><span class="s1">&#39;hauptinhalt&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">),</span>
     <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;filter-spalte&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">)],</span>
    <span class="p">[</span><span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-allgemein&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-vergleich&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;nav-admin&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
     <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;hauptinhalt&#39;</span><span class="p">,</span> <span class="s1">&#39;children&#39;</span><span class="p">)],</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">steuere_layout_und_filter</span><span class="p">(</span><span class="n">nav_allgemein</span><span class="p">,</span> <span class="n">nav_vergleich</span><span class="p">,</span> <span class="n">nav_admin</span><span class="p">,</span> <span class="n">aktueller_inhalt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the layout of the dashboard and the visibility of the left-side global filter section</span>
<span class="sd">    based on the selected navigation bar section.</span>

<span class="sd">    When the user navigates to the Admin section, the global filter column is hidden, and the</span>
<span class="sd">    main content area expands to full width.</span>

<span class="sd">    The function considers both the most recently clicked navigation button and the currently</span>
<span class="sd">    rendered content to determine the active section.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        nav_allgemein (int): Clicks on the &#39;Allgemein&#39; navigation button.</span>
<span class="sd">        nav_vergleich (int): Clicks on the &#39;Vergleich&#39; navigation button.</span>
<span class="sd">        nav_admin (int): Clicks on the &#39;Admin&#39; navigation button.</span>
<span class="sd">        aktueller_inhalt (component): The current content component displayed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Styles for main content and filter column:</span>
<span class="sd">            - Main content style (dict): Adjusted for full width in admin or normal width otherwise.</span>
<span class="sd">            - Filter column style (dict): Hidden in admin view, shown otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">callback_context</span>

    <span class="c1"># Determine which navigation button was clicked</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">:</span>
        <span class="n">button_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">button_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;prop_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check if the admin area is currently active by inspecting the main content&#39;s id</span>
    <span class="n">is_admin</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">aktueller_inhalt</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">)</span> <span class="ow">and</span>
            <span class="s1">&#39;id&#39;</span> <span class="ow">in</span> <span class="n">aktueller_inhalt</span><span class="o">.</span><span class="n">props</span> <span class="ow">and</span>
            <span class="n">aktueller_inhalt</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;admin-inhalt&#39;</span><span class="p">):</span>
        <span class="n">is_admin</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># If admin nav clicked or admin content active, show main content full width and hide filter column</span>
    <span class="k">if</span> <span class="n">button_id</span> <span class="o">==</span> <span class="s1">&#39;nav-admin&#39;</span> <span class="ow">or</span> <span class="n">is_admin</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;flex&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">},</span>  <span class="c1"># Main content - full width</span>
            <span class="p">{</span><span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>  <span class="c1"># Hide global filter column</span>
        <span class="p">)</span>
    <span class="c1"># For other navs, show normal layout with filter column visible</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;flex&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span> <span class="s1">&#39;minWidth&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">},</span>  <span class="c1"># Main content - normal width</span>
            <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="s1">&#39;20%&#39;</span><span class="p">,</span> <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;20px&#39;</span><span class="p">,</span> <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;block&#39;</span><span class="p">}</span>  <span class="c1"># Show filter column</span>
        <span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Larissa Stein.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>